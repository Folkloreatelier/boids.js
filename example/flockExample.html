<!DOCTYPE HTML>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<title>SEEK EXAMPLE</title>
	
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
	<script type="text/javascript" src="js/Three.js"></script>
	<script type="text/javascript" src="../src/boids.js"></script>
	<script type="text/javascript" src="../src/core/Vehicle.js"></script>
	<script type="text/javascript" src="../src/core/SteeredVehicle.js"></script>
	<script type="text/javascript">
	
	
	var camera, scene, renderer,
	    geometry, material, mesh1, mesh2, mesh3;
	
	
	var meshs = [], flocks = [], flockNum = 100;
	
	
	    function init() {

	        scene = new THREE.Scene();

	        camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 10000 );
	        camera.position.z = 1000;
	        scene.add( camera );

	        geometry = new THREE.CylinderGeometry( 1, 10, 10 );
	        material = new THREE.MeshBasicMaterial( { color: 0xff0000, wireframe: true } );

	        // mesh1 = new THREE.Mesh( geometry, material );
	        // scene.add( mesh1 );
			
			renderer = new THREE.WebGLRenderer();
	        renderer.setSize( window.innerWidth, window.innerHeight );

	        document.body.appendChild( renderer.domElement );
			
			
			for (var i = 0; i < flockNum; i++) {
				
				var v = new boids.SteeredVehicle();
				// v.maxSpeed = 20;
				// v.maxForce = 4;
				v.inSightDist = 800;
				v.tooCloseDist = 80;
				v.position.set(
					Math.random() * 800 -400, 
					Math.random() * 800 -400, 
					Math.random() * 800 -400
			 	);
				
				flocks.push(v);
				
				
				var mesh = new THREE.Mesh( geometry, material );
		        scene.add( mesh );
				meshs.push(mesh);
			}
			
	    }

	    function animate() {

	        // note: three.js includes requestAnimationFrame shim
	        // requestAnimationFrame( animate );
			
			
			for (var i = 0; i < flockNum; i++) {
				
				flocks[i].flock(flocks);
				flocks[i].update();
				flocks[i].wrap();
			}
			
			setTimeout(animate, 1000 / 30);
	        render();
	    }

	    function render() {
			
			
			for (var i = 0; i < flockNum; i++) {
				
				meshs[i].lookAt(flocks[i].velocity);
				meshs[i].position = flocks[i].position;
			}
			
	        renderer.render( scene, camera );
	    }
		
		$(document).ready(function() {
			
			
			init();
		    animate();
		});
		
	</script>
	
</head>
<body>
	
</body>
</html>